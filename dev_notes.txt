PLEASE remember to use vector.size() instead of max_size(). this lack of awareness caused a long-time unsolvable bug in main()
